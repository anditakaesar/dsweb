{"version":3,"sources":["../../src/helper/sessionHelper.js"],"names":["checkSession","req","res","next","session","user","undefined","message","redirect","checkSessionApi","data","error","meta","intmsg","validatePassword","pass","hash","bcrypt","compareSync"],"mappings":";;;;;;;AAAA;;;;AAEO,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9C,MAAIF,GAAG,CAACG,OAAJ,CAAYC,IAAZ,KAAqBC,SAAzB,EAAoC;AAClCJ,IAAAA,GAAG,CAACK,OAAJ,GAAc,gBAAd;AACAL,IAAAA,GAAG,CAACM,QAAJ,CAAa,aAAb;AACD,GAHD,MAGO;AACLL,IAAAA,IAAI;AACL;AACF,CAPM;;;;AASA,IAAMM,eAAe,GAAG,SAAlBA,eAAkB,CAACR,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACjD,MAAIF,GAAG,CAACG,OAAJ,CAAYC,IAAZ,KAAqBC,SAAzB,EAAoC;AAClCJ,IAAAA,GAAG,CAACQ,IAAJ,CAASC,KAAT,GAAiB;AACfJ,MAAAA,OAAO,EAAE,gBADM;AAEfK,MAAAA,IAAI,EAAE;AACJC,QAAAA,MAAM,EAAE;AADJ;AAFS,KAAjB;AAMAV,IAAAA,IAAI,CAACD,GAAG,CAACQ,IAAJ,CAASC,KAAV,CAAJ;AACD,GARD,MAQO;AACLR,IAAAA,IAAI;AACL;AACF,CAZM;;;;AAcA,IAAMW,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,IAAD,EAAOC,IAAP,EAAgB;AAC9C,SAAOC,mBAAOC,WAAP,CAAmBH,IAAnB,EAAyBC,IAAzB,CAAP;AACD,CAFM","sourcesContent":["import bcrypt from 'bcrypt'\r\n\r\nexport const checkSession = (req, res, next) => {\r\n  if (req.session.user === undefined) {\r\n    res.message = 'You must login'\r\n    res.redirect('/auth/login')\r\n  } else {\r\n    next()\r\n  }\r\n}\r\n\r\nexport const checkSessionApi = (req, res, next) => {\r\n  if (req.session.user === undefined) {\r\n    res.data.error = {\r\n      message: 'You must login',\r\n      meta: {\r\n        intmsg: 'accessing checkSessionApi',\r\n      },\r\n    }\r\n    next(res.data.error)\r\n  } else {\r\n    next()\r\n  }\r\n}\r\n\r\nexport const validatePassword = (pass, hash) => {\r\n  return bcrypt.compareSync(pass, hash)\r\n}"],"file":"sessionHelper.js"}