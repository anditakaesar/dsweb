{"version":3,"sources":["../../src/helper/sessionHelper.js"],"names":["checkSession","req","res","next","session","user","undefined","message","redirect","checkSessionApi","error","validatePassword","pass","hash","bcrypt","compareSync"],"mappings":";;;;;;;;;AAAA;;AACA;;AAEO,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9C,MAAIF,GAAG,CAACG,OAAJ,CAAYC,IAAZ,KAAqBC,SAAzB,EAAoC;AAClCJ,IAAAA,GAAG,CAACK,OAAJ,GAAc,gBAAd;AACAL,IAAAA,GAAG,CAACM,QAAJ,CAAa,aAAb;AACD,GAHD,MAGO;AACLL,IAAAA,IAAI;AACL;AACF,CAPM;;;;AASA,IAAMM,eAAe,GAAG,SAAlBA,eAAkB,CAACR,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACjD,MAAIF,GAAG,CAACG,OAAJ,CAAYC,IAAZ,KAAqBC,SAAzB,EAAoC;AAClC,QAAII,KAAK,GAAG,6BAAS,IAAT,EAAeT,GAAf,CAAZ;AACAS,IAAAA,KAAK,CAACH,OAAN,GAAgB,gBAAhB;AACAJ,IAAAA,IAAI,CAACO,KAAD,CAAJ;AACD,GAJD,MAIO;AACLP,IAAAA,IAAI;AACL;AACF,CARM;;;;AAUA,IAAMQ,gBAAgB,GAAG,SAAnBA,gBAAmB,CAACC,IAAD,EAAOC,IAAP,EAAgB;AAC9C,SAAOC,mBAAOC,WAAP,CAAmBH,IAAnB,EAAyBC,IAAzB,CAAP;AACD,CAFM","sourcesContent":["import bcrypt from 'bcrypt'\r\nimport genError from './errorHelper'\r\n\r\nexport const checkSession = (req, res, next) => {\r\n  if (req.session.user === undefined) {\r\n    res.message = 'You must login'\r\n    res.redirect('/auth/login')\r\n  } else {\r\n    next()\r\n  }\r\n}\r\n\r\nexport const checkSessionApi = (req, res, next) => {\r\n  if (req.session.user === undefined) {\r\n    let error = genError(null, req)\r\n    error.message = 'You Must Login'\r\n    next(error)\r\n  } else {\r\n    next()\r\n  }\r\n}\r\n\r\nexport const validatePassword = (pass, hash) => {\r\n  return bcrypt.compareSync(pass, hash)\r\n}"],"file":"sessionHelper.js"}